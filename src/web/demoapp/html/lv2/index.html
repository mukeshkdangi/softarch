<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <link rel="stylesheet" href="index.css">
      <script src="https://d3js.org/d3.v4.min.js"></script>
      <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">        <title>CSCI578-Project</title>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <script src="../javascript/color.js"></script>
      <script src="../lv2/lv2_modifier.js"></script>

      <script>
        function getParameterByName(name, url) {
          if (!url) url = window.location.href;
          name = name.replace(/[\[\]]/g, "\\$&");
          var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
              results = regex.exec(url);
          if (!results) return null;
          if (!results[2]) return '';
          return decodeURIComponent(results[2].replace(/\+/g, " "));
        }
        var category = getParameterByName("cluster_name");
        if (category === undefined) category = "sql";
      </script>
  </head>
  <body>
      <div id="title">CSCI578 - Final Project 
        <button id="back-button" onClick="window.location.href='/lv1/index.html'">Go back to Lv1</button>
      </div>
      <div id="legend">Legend :
          <i class="fa fa-circle" style="color:#F99157"></i> sql
          <i class="fa fa-circle" style="color:#FAC863"></i> gui
          <i class="fa fa-circle" style="color:#99C794"></i> io
          <i class="fa fa-circle" style="color:#5FB3B3"></i> networking
          <i class="fa fa-circle" style="color:#6699CC"></i> sound
          <i class="fa fa-circle" style="color:#C594C5"></i> graphics
          <i class="fa fa-circle" style="color:#eef5db"></i> no_match
      </div>
      <div id="svg-container"><svg id="main-svg" width="1333" height="800"></svg></div>
      <script>
        var svgWidth = window.innerWidth;
        var svgHeight = window.innerHeight - 70;
        var d = document.getElementById("main-svg");
        d.setAttribute("width", svgWidth);
        d.setAttribute("height", svgHeight);
        window.onload = function(){
          var xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
              if (this.readyState == 4 && this.status == 200) {
                var a = xhttp.responseText;
                var data = JSON.parse(a);
                var category_position = data["levelTwo"].map(function(x) {return x.name; }).indexOf(category)
                var lv2_data = data["levelTwo"][category_position].clusterNames.listOfFiles
                var root = modifyData(lv2_data, category)
                drawSVG(root, lv2_data);
              }
          };
          xhttp.open("GET", "/data/data.json", true);
          xhttp.send();

        }
       
      </script>
      <script src="index.js"></script>
  </body>
</html>